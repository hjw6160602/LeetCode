//
//  1013.将数组分成和相等的三个部分.swift
//  Array
//
//  Created by 江雪 on 2021/2/18.
//  Copyright © 2021 saidicaprio. All rights reserved.
//  https://leetcode-cn.com/problems/partition-array-into-three-parts-with-equal-sum/submissions/

import Foundation

// 给你一个整数数组 A，只有可以将其划分为三个和相等的非空部分时才返回 true，否则返回 false。
//
// 形式上，如果可以找出索引 i+1 < j 且满足
// A[0] + A[1] + ... + A[i] =
// A[i+1] + A[i+2] + ... + A[j-1] =
// A[j] + A[j-1] + ... + A[A.length - 1]
// 就可以将数组三等分。

extension Solution {
    func canThreePartsEqualSum(_ A: [Int]) -> Bool {
        var sum = A.reduce(0, +)
        guard sum % 3 == 0 else {
            return false
        }
        sum /= 3
        var part = 0
        var count = 0
        for item in A {
            part += item
            if part != sum {
                continue
            }
            count += 1
            if count == 3 {
                return true
            }
            part = 0
        }
        
        return false
    }
    
    func canThreePartsEqualSum_Wrong(_ A: [Int]) -> Bool {
        let maxIndex = A.count - 1
        for index1 in 0 ..< maxIndex - 1 {
            for index2 in index1+1 ..< maxIndex {
                let sum1 = sum(A, 0, index1)
                let sum2 = sum(A, index1+1, index2)
                let sum3 = sum(A, index2+1, maxIndex)
                if sum1 == sum2 && sum3 == sum1 {
                    return true
                }
            }
        }
        return false
    }
    
    private func sum(_ arr: [Int], _ index1: Int, _ index2: Int) -> Int {
        var sum = 0
        for i in index1...index2 {
            sum += arr[i]
        }
        return sum
    }
}

//let s = Solution()
//print(s.canThreePartsEqualSum([1057,4651,-1238,-942,1623,1985,-1875,2482,-3992,1550,-4603,-575,2805,1668,327,1516,-715,-4439,3702,-1020,-3694,6952,-531,1546,-5521,3123,3113,-2816,2858,-5184,3196,-2759,574,3702,-3996,3632,-4621,-2506,5628,-4539,1585,1147,-1813,4062,-7001,-15,2938,-358,-1801,6097,1585,-7374,2081,4407,-5350,5966,-3675,1748,-355,-974,2985,-924,-2949,1202,-1006,-3818,1109,2143,-736,1081,-3122,-796,5423,-3012,-2536,2810,3567,689,-5103,4305,-5694,4616,-855,3195,-5161,5653,-3057,-1053,-117,1202,-2952,1657,-3184,5715,-5107,26,3187,-2354,1097,-2732,5725,-5230,6922,1118,-4578,1905,1380,-2516,-4593,1917,460,-1889,-834,865,5985,-1254,1954,-7697,7406,1457,-8654,5691,-3911,3991,340,-3949,-1987,5301,-1655,761,4063,-2048,-1693,1442,-4334,1327,-3429,8390,-1086,-7235,5295,-2123,5386,-8248,3595,-934,5310,-7494,1074,-1775,2397,-2646,2620,4714,-4864,4912,-3593,-1002,1256,3488,-299,-2438,720,-4651,6131,463,-938,-1472,-4429,6891,-4142,568,-1153,228,-518,5999,-7826,1505,1123,2912,1373,-2623,806,1714,-4475,-2211,6954,-627,-5933,793,4480,2049,-5232,1438,918,-1942,-2364,2598,3586,-6494,5376,-3263,2222,-3891,-1463,5564,-1979,4459,-778,1185,-2929,488,-4491,4083,-1460,796,-349,-3232,3196,-2321,-1267,1646,5305,-929,1289,-5957,881,-1975,6562,-4627,3741,-1735,-5209,1113,7041,-8163,7056,-2429,-4359,6324,-2915,4012,-728,-1301,-5337,4506,-3371,841,-119,3723,-672,-4688,5190,-3010,2921,-5483,2425,622,-1870,-1104,6791,35,1034,-6711,6975,-1813,-873,-557,-494,2679,-6581,2227,-2165,1853,760,-746,-307,3551,-1812,2663,-6562,2316,-2340,2344,5588,487,-1365,-5027,1113,-396,2850,-4222,6937,-3120,3452,-3582,2093,-2375,-621,4203,-1566,-2271,1127,-3918,238,695,3315,-5694,6319,-2261,1499,571,-5802,-111,2890,46,-972,3625,-409,-4752,1591,2486,3007,-1137,-5308,5860,38,69,-2365,-1935,-747,-2375,1908,2016,1527,-1111,3650,-7340,3683,280,-762,983,-4808,37,5177,-5222,-270,3582,589,1681,-572,3462,-3316,1689,52,616,-1499,2324,-750,-4553,-2428,7057,-5359,4007,-1470,2842,-5218,2292,-2190,5626,-2979,1887,-901,-5867,7362,-6997,5916,-2205,304,-3842,6345,-6209,619,-677,-135,4352,1259,-4527,6709,-331,-3166,-3392,4013,-5202,5413,-4694,3580,-3224,2289,-1285,-2032,4040,-1782,1117,-4099,1113,-587,1705,5639,-6872,1385,585,-1814,1760,426,2733,-1980,-979,796,-1408,4697,-4497,-2300,5558,-4827,4169,-3822,-997,4749,-3728,7114,-6221,5552,472,-475,849,-8449,1209,3678,1431,785,-2018,1639,-43,-1837,-2606,-726,-773,1865,4119,-354,-110,-4746,298,-195,-864,3571,1430,-516,-969,-1845,5907,-4618,2217,-3472,-284,-1893,3019,-1419,609,-688,2736,1649,-3988,365,2731,-3302,3210,-877,-312,-3154,3250,-2069,2899,2860,-5489,-1230,4975,-4851,3867,-3269,5095,1211,-178,-7329,516,390,5543,-2158,-3014,5922,-4115,-3695,7307,515,-6343,1779,4176,-2233,-5259,736,2427,373,-748,2119,-366,-766,1654,-1152,-3641,-894,3551,-167,211,4707,-909,-7402,3734,4912,-6809,2350,-36,3912,-7460,3381,-1180,-2815,5693,-230,-3579,2541,-1204,3012,1143,-1284,-1884,48,-1524,1758,2881,-2496,-1422,2112,-2282,715,-547,3271,-5083,-262,2593,1846,-3688,-1694,3675,2472,982,-1273,-5323,2241,-102,34,-1952,4623,-675,825,-1242,-1932,-926,3608,-5622,7357,-6984,7236,87,-5026,464,64,1315,-2890,-1427,2026,4742,-1348,-3346,1995,-2321,5528,-6475,1543,952,2092,138,-2571,5085,-3485,-3567,152,2629,-3659,8004,-5455,854,-151,-257,-2779,3661,-3930,932,2767,3028,-4418,-707,4816,-1997,-1417,-3267,3110,-1044,-1936,7426,-2155,-3866,792,-462,5764,-3638,-801,3918,-3043,3376,-1421,-3515,5173,-2833,3441,-7620,2539,-2936,6307,-3158,3708,-4269,-1037,-430,-949,3317,-1702,-1822,1970,1367,379,1182,3209,-1117,1767,-2669,1474,-1044,451,-60,-5534,7009,-5179,-2922,7977,-2335,1343,-7065,6754,595,434,-1030,-462,2128,-8182,791,388,6017,390,-2696,-3156,-701,7186,-6641,1598,-2915,624,324,-679,-165,6378,-5787,5166,-1202,657,-3781,2905,2163,-756,-5509,2674,-3124,445,2464,1346,-1234,-2170,6832,-7970,4143,-3283,5810,-1354,230,-4811,3504,706,-4397,1545,427,-2410,4575,923,-3317,2455,-3252,2767,3651,-3099,-4101,953,327,-660,3828,190,-3398,5018,-1467,-5013,6774,-5203,-2504,1620,3381,-548,-2425,3605,-982,-938,5182,-7082,1875,977,-988,3194,-1827,-2347,1872,-1927,3646,1524,-5579,969,1972,-1930,3858,-5960,-1124,6692,-856,820,1262,-2646,2036,-7072,-342,3953,927,-1582,5218,-7502,4812,-5644,3943,-570,733,3191,-2514,-9,2385,-995,-6214,2640,548,-2960,8620,-8857,2850,1503,1063,-3942,-791,5072,-1523,-1471,2469,110,345,-4831,6459,-2522,-806,3748,-6980,5117,-531,-5134,1582,872,-603,4570,-4671,359,4085,-4900,4146,-1955,1366,-2947,630,4077,-4127,-1034,2729,1744,197,428,-6856,6330,-2890,3034,-4030,3019,1658,-5384,1919,-2137,7367,-7383,-1172,8070,-7960,7259,-1438,-1712,-3123,6653,-6851,867,5217,-7270,4706,-456,4367,212,-2353,-1910,785,3127,-5768,5639,288,-5460,3011,-3386,-1533,5166,-2551,261,1752,-68,2077,307,-2039,-2420,1171,2952,-2382,2705,-3560,1691,-5857,5634,2817,-2255,-4998,6046,-699,-1508,1164,545,-2763,1063,-5261,8561,-8811,7790,-7319,7998,-219,-3148,3121,-7922,425,7476,-712,-3227,3316,459,-6534,4475,-2757,2310,1843,-1169,-5591,4499,3217,-712,-1660,1068,-6625,5121,-4523,7544,-4510,294,590,-2295,-1196,-1010,4168,-3130,4913,-6225,2448,1456,1761,-4068,-274,7217,-4978,-500,-493,1094,-2064,544,6129,-5067,915,2745,-4478,225,5658,-5703,3674,-1477,-2259,4566,-5440,3766,-1719,-3279,1778,-1917,-92,554,5333,398,-4175,4146,-6214,6852,-1537,-3555,1798,-2255,5553,-5353,4402,-3603,258,6008]))
